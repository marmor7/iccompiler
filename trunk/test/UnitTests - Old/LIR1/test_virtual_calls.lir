############################################
# Compiled from testlir/test_virtual_calls.ic
############################################

############################################
# String literals:
############################################
str0: "In Foo_rise"

str1: "In Foo_shine"

str2: "In Bar_rise"

str3: "In Bar_twinkle"

str_null_ref: "Runtime Error: Null pointer dereference!"
str_arr_out_of_bound: "Runtime Error: Array index out of bounds!"
str_neg_arr_size: "Runtime Error: Array allocation with negative array size!"
str_zero_div: "Runtime Error: Division by zero!"

############################################
# Dispatch tables:
############################################
_DV_Foo: [_Foo_rise, _Foo_shine]
# Field offset table for _DV_Foo:
# y: 1
# x: 2
# Method offset table for _DV_Foo:
# rise: 0
# shine: 1

_DV_Bar: [_Bar_rise, _Foo_shine, _Bar_twinkle]
# Field offset table for _DV_Bar:
# y: 1
# x: 2
# z: 3
# Method offset table for _DV_Bar:
# rise: 0
# shine: 1
# twinkle: 2


############################################
# Commands:
############################################


##############Foo.rise##############
_Foo_rise:
Move str0, R2
Library __println(R2), R1
Move x, R2
Library __printi(R2), R1
Move 2, R1
Return R1
Return 9999
############################################



##############Foo.shine##############
_Foo_shine:
Move str1, R2
Library __println(R2), R1
Move x, R2
Library __printi(R2), R1
Move 1, R1
Return R1
Return 9999
############################################



##############Foo.main##############
_ic_main:
Library __allocateObject(16), R1
MoveField _DV_Bar, R1.0
Move R1, f_19
Move f_19, R1
Compare 0, R1
JumpTrue _null_ref
Move 1, R2
VirtualCall R1.0(x=R2), R1
Move f_19, R1
Compare 0, R1
JumpTrue _null_ref
Move 2, R2
VirtualCall R1.1(x=R2), R1
Library __allocateObject(12), R1
MoveField _DV_Foo, R1.0
Move R1, f_19
Move f_19, R1
Compare 0, R1
JumpTrue _null_ref
Move 4, R2
VirtualCall R1.0(x=R2), R1
Move f_19, R1
Compare 0, R1
JumpTrue _null_ref
Move 5, R2
VirtualCall R1.1(x=R2), R1
Library __allocateObject(16), R1
MoveField _DV_Bar, R1.0
Move R1, b_19
Move b_19, R1
Compare 0, R1
JumpTrue _null_ref
Move 3, R2
VirtualCall R1.2(x=R2), R1
Library __exit(0), Rdummy
############################################



##############Bar.rise##############
_Bar_rise:
Move str2, R2
Library __println(R2), R1
Move x, R2
Library __printi(R2), R1
Move 3, R1
Return R1
Return 9999
############################################



##############Bar.twinkle##############
_Bar_twinkle:
Move str3, R2
Library __println(R2), R1
Move x, R2
Library __printi(R2), R1
Move 4, R1
Return R1
Return 9999
############################################

############################################

_null_ref:
Library __println(str_null_ref), Rdummy
Library __exit(1), Rdummy

_arr_out_of_bound:
Library __println(str_arr_out_of_bound), Rdummy
Library __exit(1), Rdummy

_neg_arr_size:
Library __println(str_neg_arr_size), Rdummy
Library __exit(1), Rdummy

_zero_div:
Library __println(str_zero_div), Rdummy
Library __exit(1), Rdummy


